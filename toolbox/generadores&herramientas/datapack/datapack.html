<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Datapack Creator - Minecraft</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../../../assets/footer/footer.css">
    <style>
        /* Estilos para la p√°gina del creador de datapacks */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        :root {
            --primary: #ff6b6b;
            --primary-dark: #ff4757;
            --secondary: #70a1ff;
            --accent: #1e90ff;
            --dark: #0c0c1d;
            --light: #ffffff;
            --gray: #2d3748;
            --gray-light: #4a5568;
            --success: #2ed573;
            --warning: #ffa502;
            --danger: #ff4757;
        }

        body {
            background: linear-gradient(135deg, #0c0c1d 0%, #1a1a2e 50%, #16213e 100%);
            color: #e2e8f0;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(255, 107, 107, 0.15) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(112, 161, 255, 0.12) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(30, 144, 255, 0.08) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }
body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
    z-index: -1;
}

        /* Contenedor principal */
        .datapack-creator {
            position: relative;
            z-index: 1;
            padding: 80px 20px 40px;
            max-width: 1400px;
            margin: 0 auto;
        }

        /* Header estilizado - SIN BORDE NI FONDO */
        .creator-header {
            text-align: center;
            margin-bottom: 60px;
            position: relative;
            padding: 0;
            background: transparent;
            backdrop-filter: none;
            border-radius: 0;
            border: none;
            box-shadow: none;
        }

        .creator-header h1 {
            font-size: 5rem;
            font-weight: 900;
            background: linear-gradient(135deg, #ff6b6b 0%, #70a1ff 50%, #1e90ff 100%);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 10px;
            letter-spacing: -2px;
            text-shadow: 0 8px 30px rgba(255, 107, 107, 0.5);
            text-transform: uppercase;
            line-height: 1;
        }

        /* Tarjeta del formulario - M√ÅS TRANSPARENTE Y SIN BORDE */
        .form-card {
            background: rgba(15, 15, 30, 0.35);
            backdrop-filter: blur(35px);
            border-radius: 15px;
            padding: 40px;
            box-shadow: 
                0 15px 50px rgba(0, 0, 0, 0.3),
                0 0 0 0px rgba(255, 107, 107, 0);
            border: 1px solid rgba(255, 255, 255, 0.03);
            margin-bottom: 50px;
            position: relative;
            overflow: hidden;
        }

        .form-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 15px 15px 0 0;
            opacity: 0.6;
        }

        .form-title {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 40px;
        }

        .form-title i {
            font-size: 2.5rem;
            color: var(--primary);
            background: rgba(255, 107, 107, 0.08);
            padding: 15px;
            border-radius: 12px;
        }

        .form-title h2 {
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--light);
            margin: 0;
            text-shadow: 0 2px 10px rgba(255, 255, 255, 0.1);
            opacity: 0.9;
        }

        /* Grid del formulario */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        /* Grupos de formulario */
        .form-group {
            position: relative;
        }

        .form-label {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--secondary);
            margin-bottom: 12px;
            padding-left: 5px;
            opacity: 0.9;
        }

        .form-label i {
            color: var(--primary);
        }

        .input-hint {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.55);
            margin-top: 5px;
            display: flex;
            align-items: center;
            gap: 5px;
            opacity: 0.8;
        }

        .form-input {
            width: 100%;
            padding: 18px 20px;
            background: rgba(10, 10, 20, 0.5);
            border: 1px solid rgba(255, 107, 107, 0.25);
            border-radius: 10px;
            color: var(--light);
            font-size: 1.05rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-family: 'Consolas', 'Monaco', monospace;
            text-transform: lowercase;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(255, 107, 107, 0.15);
            background: rgba(10, 10, 20, 0.7);
            transform: translateY(-2px);
        }

        .form-input::placeholder {
            color: rgba(255, 255, 255, 0.35);
        }

        /* Bot√≥n de descarga */
        .download-section {
            text-align: center;
            margin-top: 50px;
            padding-top: 40px;
            border-top: 1px solid rgba(255, 107, 107, 0.08);
        }

        .download-btn {
            display: inline-flex;
            align-items: center;
            gap: 15px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            padding: 22px 60px;
            font-size: 1.4rem;
            font-weight: 700;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 10px 30px rgba(255, 107, 107, 0.35),
                0 0 0 0px rgba(255, 255, 255, 0);
        }

        .download-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.15), transparent);
            transition: 0.5s;
        }

        .download-btn:hover {
            transform: translateY(-5px);
            box-shadow: 
                0 20px 40px rgba(255, 107, 107, 0.5),
                0 0 0 0px rgba(255, 255, 255, 0);
        }

        .download-btn:hover::before {
            left: 100%;
        }

        .download-btn:active {
            transform: translateY(-2px);
        }

        .download-btn i {
            font-size: 1.6rem;
        }

        /* Estructura del datapack - M√ÅS TRANSPARENTE */
        .structure-card {
            background: rgba(15, 15, 30, 0.35);
            backdrop-filter: blur(35px);
            border-radius: 15px;
            padding: 40px;
            box-shadow: 
                0 15px 50px rgba(0, 0, 0, 0.3),
                0 0 0 0px rgba(112, 161, 255, 0);
            border: 1px solid rgba(255, 255, 255, 0.03);
            margin-bottom: 50px;
        }

        .structure-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 35px;
        }

        .structure-header i {
            font-size: 2.5rem;
            color: var(--secondary);
            background: rgba(112, 161, 255, 0.08);
            padding: 15px;
            border-radius: 12px;
        }

        .structure-header h2 {
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--light);
            margin: 0;
            text-shadow: 0 2px 10px rgba(255, 255, 255, 0.1);
            opacity: 0.9;
        }

        .structure-preview {
            background: rgba(10, 10, 20, 0.6);
            border-radius: 10px;
            padding: 35px;
            font-family: 'Cascadia Code', 'Consolas', 'Monaco', monospace;
            font-size: 1.1rem;
            line-height: 1.8;
            border: 1px solid rgba(255, 107, 107, 0.08);
            overflow-x: auto;
            position: relative;
        }

        .folder {
            color: #70a1ff;
            font-weight: 600;
        }

        .file {
            color: #2ed573;
        }

        .json-file {
            color: #ffa502;
        }

        .mcfunction-file {
            color: #ff6b6b;
        }

        .structure-line {
            display: flex;
            align-items: center;
            gap: 10px;
            padding-left: 30px;
            position: relative;
            min-height: 28px;
            white-space: nowrap;
        }

        .structure-line::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            width: 20px;
            height: 1px;
            background: rgba(255, 107, 107, 0.15);
        }

        .indent-1 { padding-left: 30px; }
        .indent-2 { padding-left: 60px; }
        .indent-3 { padding-left: 90px; }
        .indent-4 { padding-left: 120px; }
        .indent-5 { padding-left: 150px; }
        .indent-6 { padding-left: 180px; }

        /* Responsive */
        @media (max-width: 768px) {
            .datapack-creator {
                padding: 60px 15px 30px;
            }
            
            .creator-header h1 {
                font-size: 3.5rem;
            }
            
            .form-card,
            .structure-card {
                padding: 30px 20px;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .download-btn {
                padding: 18px 40px;
                font-size: 1.2rem;
                width: 100%;
                justify-content: center;
            }
            
            .structure-preview {
                padding: 20px;
                font-size: 0.95rem;
            }
            
            .structure-line {
                padding-left: 20px;
                min-height: 24px;
            }
        }

        /* Animaciones */
        @keyframes pulse {
            0% { box-shadow: 0 10px 30px rgba(255, 107, 107, 0.35); }
            50% { box-shadow: 0 10px 40px rgba(255, 107, 107, 0.6); }
            100% { box-shadow: 0 10px 30px rgba(255, 107, 107, 0.35); }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .form-card, .structure-card {
            animation: fadeInUp 0.6s ease-out;
        }

        .download-btn {
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body>
    <!-- Barra de navegaci√≥n -->
    <nav class="mc-navbar">
        <button class="mc-mobile-menu-btn">
            <i class="fas fa-bars"></i>
        </button>

        <img src="../../../assets/img/logo/logo.png" alt="Logo" class="mc-logo">

        <ul class="mc-nav-menu">
            <li><a href="../../../index.html">Index</a></li>
            <li><a href="../../../toolbox/hub/proyectos/proyectos.html">Proyectos</a></li>
            <li><a href="../../../toolbox/hub/colaboradores/colaboradores.html">Colaboradores</a></li>
            <li><a href="../../../toolbox/hub/contacto/contacto.html">Contacto</a></li>
        </ul>

        <div class="mc-nav-right">
            <div class="mc-social-icons">
                <a href="https://www.instagram.com/iamkarl02/"><i class="fab fa-instagram"></i></a>
                <a href="https://www.youtube.com/@iamkarl02"><i class="fab fa-youtube"></i></a>
                <a href="https://www.tiktok.com/@iamkarl02"><i class="fab fa-tiktok"></i></a>
            </div>
            <div class="mc-language-selector">
                <div class="mc-language-icon">
                    <i class="fas fa-globe-americas"></i>
                </div>
                <div class="mc-language-options">
                    <a href="#">Espa√±ol</a>
                    <a href="#">English</a>
                </div>
            </div>
        </div>
    </nav>

    <div class="mc-navbar-spacer"></div>

    <!-- Contenido principal -->
    <div class="datapack-creator">
        <div class="creator-header">
        </div>

        <!-- Formulario de creaci√≥n -->
        <div class="form-card">
            <div class="form-title">
                <i class="fas fa-wrench"></i>
                <h2>Configuraci√≥n del Datapack</h2>
            </div>

            <div class="form-grid">
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-folder"></i>
                        Nombre del Datapack
                    </label>
                    <input type="text" class="form-input" id="datapackName" 
                           placeholder="Ej: mi_datapack_epico" 
                           oninput="updateStructure()">
                    <div class="input-hint">
                        <i class="fas fa-info-circle"></i>
                        Solo min√∫sculas, n√∫meros y guiones bajos (_)
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-at"></i>
                        Namespace
                    </label>
                    <input type="text" class="form-input" id="namespace" 
                           placeholder="Ej: mi_datapack"
                           oninput="updateStructure()">
                    <div class="input-hint">
                        <i class="fas fa-info-circle"></i>
                        Usa solo min√∫sculas y guiones bajos
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-gamepad"></i>
                        Versi√≥n de Minecraft
                    </label>
                    <select class="form-input" id="minecraftVersion" onchange="updateVersionInfo()">
                        <option value="1.21.6" data-packformat="80">1.21.6 (Pack Format: 80)</option>
                        <option value="1.21.5" data-packformat="71">1.21.5 (Pack Format: 71)</option>
                        <option value="1.21.4" data-packformat="61">1.21.4 (Pack Format: 61)</option>
                        <option value="1.21.3" data-packformat="57">1.21.3 (Pack Format: 57)</option>
                        <option value="1.21.2" data-packformat="57">1.21.2 (Pack Format: 57)</option>
                        <option value="1.21" data-packformat="48">1.21 (Pack Format: 48)</option>
                        <option value="1.20.6" data-packformat="41">1.20.6 (Pack Format: 41)</option>
                        <option value="1.20.5" data-packformat="41">1.20.5 (Pack Format: 41)</option>
                        <option value="1.20.4" data-packformat="26">1.20.4 (Pack Format: 26)</option>
                        <option value="1.20.3" data-packformat="26">1.20.3 (Pack Format: 26)</option>
                        <option value="1.20.2" data-packformat="18">1.20.2 (Pack Format: 18)</option>
                        <option value="1.20.1" data-packformat="15">1.20.1 (Pack Format: 15)</option>
                        <option value="1.20" data-packformat="15" selected>1.20 (Pack Format: 15)</option>
                        <option value="1.19.4" data-packformat="12">1.19.4 (Pack Format: 12)</option>
                        <option value="1.19.3" data-packformat="10">1.19.3 (Pack Format: 10)</option>
                        <option value="1.19" data-packformat="10">1.19 (Pack Format: 10)</option>
                        <option value="1.18.2" data-packformat="9">1.18.2 (Pack Format: 9)</option>
                        <option value="1.18.1" data-packformat="8">1.18.1 (Pack Format: 8)</option>
                        <option value="1.18" data-packformat="8">1.18 (Pack Format: 8)</option>
                        <option value="1.17.1" data-packformat="7">1.17.1 (Pack Format: 7)</option>
                        <option value="1.17" data-packformat="7">1.17 (Pack Format: 7)</option>
                        <option value="1.16.5" data-packformat="6">1.16.5 (Pack Format: 6)</option>
                        <option value="1.16.2" data-packformat="6">1.16.2 (Pack Format: 6)</option>
                        <option value="1.16.1" data-packformat="5">1.16.1 (Pack Format: 5)</option>
                        <option value="1.16" data-packformat="5">1.16 (Pack Format: 5)</option>
                        <option value="1.15" data-packformat="5">1.15 (Pack Format: 5)</option>
                        <option value="1.14.4" data-packformat="4">1.14.4 (Pack Format: 4)</option>
                        <option value="1.13" data-packformat="4">1.13 (Pack Format: 4)</option>
                    </select>
                    
                    <div class="input-hint">
                        <i class="fas fa-code"></i>
                        Pack Format: <span id="packFormatDisplay">15</span>
                    </div>
                </div>
            </div>

            <div class="download-section">
                <button class="download-btn" id="downloadBtn">
                    <i class="fas fa-download"></i>
                    Generar y Descargar Datapack
                </button>
            </div>
        </div>

    <!-- Men√∫ m√≥vil -->
    <div class="mc-mobile-menu">
        <ul class="mc-mobile-nav-menu">
            <li><a href="../../../index.html">Index</a></li>
            <li><a href="../../../toolbox/hub/proyectos/proyectos.html">Proyectos</a></li>
            <li><a href="../../../toolbox/hub/colaboradores/colaboradores.html">Colaboradores</a></li>
            <li><a href="../../../toolbox/hub/contacto/contacto.html">Contacto</a></li>
        </ul>
        
        <div class="mc-mobile-icons-container">
            <div class="mc-mobile-social-icons">
                <a href="https://www.instagram.com/iamkarl02/"><i class="fab fa-instagram"></i></a>
                <a href="https://www.youtube.com/@iamkarl02"><i class="fab fa-youtube"></i></a>
                <a href="https://www.tiktok.com/@iamkarl02"><i class="fab fa-tiktok"></i></a>
            </div>
            <div class="mc-mobile-language-bottom">
                <i class="fas fa-globe-americas"></i>
                <div class="mc-mobile-language-options">
                    <a href="#">Espa√±ol</a>
                    <a href="#">English</a>
                </div>
            </div>
        </div>
    </div>

    <script src="../../../assets/footer/footer.js"></script>
    <script src="../../../assets/background/fondo.js"></script>
    
    <!-- Script para la funcionalidad del datapack -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    
    <script>
        // Mapeo completo de pack formats
        const packFormats = {
            '1.13': 4,
            '1.14': 4,
            '1.14.4': 4,
            '1.15': 5,
            '1.16': 5,
            '1.16.1': 5,
            '1.16.2': 6,
            '1.16.3': 6,
            '1.16.4': 6,
            '1.16.5': 6,
            '1.17': 7,
            '1.17.1': 7,
            '1.18': 8,
            '1.18.1': 8,
            '1.18.2': 9,
            '1.19': 10,
            '1.19.1': 10,
            '1.19.2': 10,
            '1.19.3': 10,
            '1.19.4': 12,
            '1.20': 15,
            '1.20.1': 15,
            '1.20.2': 18,
            '1.20.3': 26,
            '1.20.4': 26,
            '1.20.5': 41,
            '1.20.6': 41,
            '1.21': 48,
            '1.21.1': 48,
            '1.21.2': 57,
            '1.21.3': 57,
            '1.21.4': 61,
            '1.21.5': 71,
            '1.21.6': 80,
            '1.21.7': 81,
            '1.21.8': 81,
            '1.21.9': 88.0,
            '1.21.10': 88.0
        };

        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            updateStructure();
        });

        // Actualizar informaci√≥n de versi√≥n
        function updateVersionInfo() {
            const versionSelect = document.getElementById('minecraftVersion');
            const selectedOption = versionSelect.options[versionSelect.selectedIndex];
            const packFormat = selectedOption.getAttribute('data-packformat');
            
            document.getElementById('packFormatDisplay').textContent = packFormat;
        }

        // Validar nombre de datapack
        function validateDatapackName(name) {
            return /^[a-z0-9_]+$/.test(name);
        }

        // Validar namespace
        function validateNamespace(namespace) {
            return /^[a-z0-9_]+$/.test(namespace);
        }

        // Actualizar vista previa de estructura - EXACTA como pediste
        function updateStructure() {
            let datapackName = document.getElementById('datapackName').value || 'mi_datapack';
            let namespace = document.getElementById('namespace').value || datapackName;
            
            // Forzar min√∫sculas y validar
            datapackName = datapackName.toLowerCase().replace(/[^a-z0-9_]/g, '_');
            namespace = namespace.toLowerCase().replace(/[^a-z0-9_]/g, '_');
            
            // Actualizar los campos con los valores validados
            document.getElementById('datapackName').value = datapackName;
            document.getElementById('namespace').value = namespace;
            
            // Obtener informaci√≥n de versi√≥n
            const versionSelect = document.getElementById('minecraftVersion');
            const version = versionSelect.value;
            
            // Determinar estructura de carpetas seg√∫n versi√≥n
            const isNewStructure = parseFloat(version) >= 1.21;
            
            // Estructura EXACTA como pediste
            let structureHTML = `
                <div class="structure-line"><span class="folder">${datapackName}</span>/</div>
                <div class="structure-line indent-1">‚îú‚îÄ‚îÄ üìÑ <span class="file">pack.mcmeta</span></div>
                <div class="structure-line indent-1">‚îî‚îÄ‚îÄ üìÅ <span class="folder">data</span>/</div>
                
                <div class="structure-line indent-2">‚îú‚îÄ‚îÄ üìÅ <span class="folder">minecraft</span>/</div>
                <div class="structure-line indent-3">‚îî‚îÄ‚îÄ üìÅ <span class="folder">tags</span>/</div>
                <div class="structure-line indent-4">‚îî‚îÄ‚îÄ üìÅ <span class="folder">${isNewStructure ? 'function' : 'functions'}</span>/</div>
                <div class="structure-line indent-5">‚îú‚îÄ‚îÄ üìÑ <span class="json-file">load.json</span></div>
                <div class="structure-line indent-5">‚îî‚îÄ‚îÄ üìÑ <span class="json-file">tick.json</span></div>
                
                <div class="structure-line indent-2">‚îî‚îÄ‚îÄ üìÅ <span class="folder">${namespace}</span>/</div>
                
                <div class="structure-line indent-3">‚îú‚îÄ‚îÄ üìÅ <span class="folder">${isNewStructure ? 'function' : 'functions'}</span>/</div>
                <div class="structure-line indent-4">‚îú‚îÄ‚îÄ üìÑ <span class="mcfunction-file">load.mcfunction</span></div>
                <div class="structure-line indent-4">‚îî‚îÄ‚îÄ üìÑ <span class="mcfunction-file">tick.mcfunction</span></div>`;
            
            // A√±adir carpetas adicionales vac√≠as
            if (isNewStructure) {
                // Estructura nueva 1.21+
                structureHTML += `
                <div class="structure-line indent-3">‚îú‚îÄ‚îÄ üìÅ <span class="folder">recipe</span>/</div>
                <div class="structure-line indent-3">‚îú‚îÄ‚îÄ üìÅ <span class="folder">advancement</span>/</div>
                <div class="structure-line indent-3">‚îú‚îÄ‚îÄ üìÅ <span class="folder">loot_table</span>/</div>
                <div class="structure-line indent-3">‚îî‚îÄ‚îÄ üìÅ <span class="folder">worldgen</span>/</div>`;
            } else {
                // Estructura antigua <1.21
                structureHTML += `
                <div class="structure-line indent-3">‚îú‚îÄ‚îÄ üìÅ <span class="folder">recipes</span>/</div>
                <div class="structure-line indent-3">‚îú‚îÄ‚îÄ üìÅ <span class="folder">advancements</span>/</div>
                <div class="structure-line indent-3">‚îú‚îÄ‚îÄ üìÅ <span class="folder">loot_tables</span>/</div>
                <div class="structure-line indent-3">‚îî‚îÄ‚îÄ üìÅ <span class="folder">worldgen</span>/</div>`;
            }
            
            document.getElementById('structurePreview').innerHTML = structureHTML;
        }

        // Funci√≥n para descargar el datapack
        document.getElementById('downloadBtn').addEventListener('click', async function() {
            let datapackName = document.getElementById('datapackName').value.trim();
            let namespace = document.getElementById('namespace').value.trim();
            const versionSelect = document.getElementById('minecraftVersion');
            const version = versionSelect.value;
            
            // Validar y limpiar nombres
            if (!validateDatapackName(datapackName)) {
                alert('‚ö†Ô∏è El nombre del datapack solo puede contener letras min√∫sculas, n√∫meros y guiones bajos (_).');
                document.getElementById('datapackName').focus();
                return;
            }
            
            if (!namespace) {
                namespace = datapackName;
            }
            
            if (!validateNamespace(namespace)) {
                alert('‚ö†Ô∏è El namespace solo puede contener letras min√∫sculas, n√∫meros y guiciones bajos (_).');
                document.getElementById('namespace').focus();
                return;
            }
            
            // Obtener pack format
            const packFormat = packFormats[version] || 15;
            
            // Crear el datapack
            await createDatapack(datapackName, namespace, version, packFormat);
        });

        // Crear el archivo ZIP del datapack - EXACTA como pediste
        async function createDatapack(datapackName, namespace, version, packFormat) {
            try {
                const zip = new JSZip();
                
                // pack.mcmeta
                const packMeta = {
                    pack: {
                        pack_format: packFormat,
                        description: `${datapackName} | Minecraft ${version} | Creado con Datapack Creator`
                    }
                };
                
                zip.file("pack.mcmeta", JSON.stringify(packMeta, null, 2));
                
                // Crear estructura de carpetas
                const dataFolder = zip.folder("data");
                
                // Determinar estructura seg√∫n versi√≥n
                const isNewStructure = parseFloat(version) >= 1.21;
                
                // minecraft/tags/functions/
                const minecraftFolder = dataFolder.folder("minecraft");
                const tagsFolder = minecraftFolder.folder("tags");
                const functionsFolder = tagsFolder.folder(isNewStructure ? "function" : "functions");
                
                // load.json - para ejecutar load.mcfunction
                const loadJson = {
                    values: [
                        `${namespace}:load`
                    ]
                };
                functionsFolder.file("load.json", JSON.stringify(loadJson, null, 2));
                
                // tick.json - para ejecutar tick.mcfunction
                const tickJson = {
                    values: [
                        `${namespace}:tick`
                    ]
                };
                functionsFolder.file("tick.json", JSON.stringify(tickJson, null, 2));
                
                // namespace personalizado
                const namespaceFolder = dataFolder.folder(namespace);
                
                // Carpeta functions con load.mcfunction y tick.mcfunction
                const myFunctionsFolder = namespaceFolder.folder(isNewStructure ? "function" : "functions");
                
                // load.mcfunction - b√°sico
                const loadFunction = `# load.mcfunction - ${datapackName}
# Se ejecuta cuando el datapack se carga con /reload

say ========================================
say ¬°Datapack ${datapackName} cargado exitosamente!
say Versi√≥n: ${version}
say Namespace: ${namespace}
say ========================================

# Configurar scoreboards
scoreboard objectives add ${namespace}.timer dummy
scoreboard objectives add ${namespace}.data dummy

# Crear marcador para el timer
summon marker ~ ~ ~ {Tags:["${namespace}.timer"],CustomName:'{"text":"${namespace} Timer"}'}

# Mensaje de bienvenida a todos los jugadores
tellraw @a ["",{"text":"[","color":"dark_gray"},{"text":"${datapackName}","color":"gold"},{"text":"]","color":"dark_gray"},{"text":" Datapack cargado correctamente","color":"green"}]`;
                
                myFunctionsFolder.file("load.mcfunction", loadFunction);
                
                // tick.mcfunction - b√°sico
                const tickFunction = `# tick.mcfunction - ${datapackName}
# Se ejecuta cada tick (20 veces por segundo)

# Incrementar timer
scoreboard players add @e[type=marker,tag=${namespace}.timer] ${namespace}.timer 1

# Ejemplo: Cada segundo (20 ticks)
execute if score @e[type=marker,tag=${namespace}.timer] ${namespace}.timer matches 20 run function ${namespace}:tick_second

# Resetear timer cada segundo
execute if score @e[type=marker,tag=${namespace}.timer] ${namespace}.timer matches 20 run scoreboard players set @e[type=marker,tag=${namespace}.timer] ${namespace}.timer 0`;
                
                myFunctionsFolder.file("tick.mcfunction", tickFunction);
                
                // tick_second.mcfunction - funci√≥n de ejemplo
                const tickSecondFunction = `# tick_second.mcfunction - ${datapackName}
# Se ejecuta cada segundo (llamada desde tick.mcfunction)

# Aqu√≠ puedes agregar l√≥gica que se ejecute cada segundo
# Por ejemplo:
# - Actualizar HUDs
# - Verificar condiciones
# - Procesar eventos peri√≥dicos

# Ejemplo: Mostrar tiempo transcurrido
scoreboard players add global ${namespace}.data 1
execute as @a run title @s actionbar {"text":"Tiempo: ","color":"gray","extra":[{"text":""},{"selector":"global","color":"gold"},{"text":"s","color":"gray"}]}`;
                
                myFunctionsFolder.file("tick_second.mcfunction", tickSecondFunction);
                
                // Crear carpetas vac√≠as adicionales
                if (isNewStructure) {
                    // Estructura nueva 1.21+
                    namespaceFolder.folder("recipe");
                    namespaceFolder.folder("advancement");
                    namespaceFolder.folder("loot_table");
                    namespaceFolder.folder("worldgen");
                } else {
                    // Estructura antigua <1.21
                    namespaceFolder.folder("recipes");
                    namespaceFolder.folder("advancements");
                    namespaceFolder.folder("loot_tables");
                    namespaceFolder.folder("worldgen");
                }
                
                // Generar y descargar el ZIP
                const content = await zip.generateAsync({type: "blob"});
                
                const link = document.createElement('a');
                link.href = URL.createObjectURL(content);
                link.download = `${datapackName}_${version.replace(/\./g, '_')}.zip`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Mostrar mensaje de √©xito
                showSuccessMessage(datapackName, namespace, version);
                
            } catch (error) {
                console.error('Error al generar el datapack:', error);
                alert('‚ùå Ocurri√≥ un error al generar el datapack. Por favor, intenta nuevamente.');
            }
        }

        // Mostrar mensaje de √©xito
        function showSuccessMessage(datapackName, namespace, version) {
            const message = `‚úÖ Datapack generado exitosamente!

üì¶ Nombre: ${datapackName}
üè∑Ô∏è Namespace: ${namespace}
üéÆ Versi√≥n: Minecraft ${version}
üìÑ Pack Format: ${packFormats[version] || 15}

üìÇ Estructura generada:
‚Ä¢ pack.mcmeta con configuraci√≥n correcta
‚Ä¢ data/minecraft/tags/functions/load.json ‚Üí referencia a tu load.mcfunction
‚Ä¢ data/minecraft/tags/functions/tick.json ‚Üí referencia a tu tick.mcfunction
‚Ä¢ data/${namespace}/functions/load.mcfunction ‚Üí funci√≥n de carga
‚Ä¢ data/${namespace}/functions/tick.mcfunction ‚Üí funci√≥n de tick (20 veces/segundo)
‚Ä¢ data/${namespace}/functions/tick_second.mcfunction ‚Üí funci√≥n de ejemplo (1 vez/segundo)
‚Ä¢ Carpetas vac√≠as: recipes, advancements, loot_tables, worldgen

üéØ Sistema incluido:
‚Ä¢ Timer autom√°tico con marcador
‚Ä¢ Scoreboards configurados
‚Ä¢ Mensajes de carga personalizados
‚Ä¢ Sistema de ticks por segundo
‚Ä¢ Listo para expandir y personalizar

üì¶ Instalaci√≥n:
1. Extrae el archivo ZIP
2. Mueve la carpeta "${datapackName}" a /datapacks de tu mundo
3. Ejecuta /reload en el juego
4. ¬°Listo! El datapack se ejecutar√° autom√°ticamente

üí° Prueba el datapack:
‚Ä¢ Ejecuta /reload para ver el mensaje de carga
‚Ä¢ Observa el actionbar que muestra el tiempo cada segundo`;

            alert(message);
        }

        // Event listeners para validaci√≥n en tiempo real
        document.getElementById('datapackName').addEventListener('input', function() {
            let value = this.value.toLowerCase().replace(/[^a-z0-9_]/g, '_');
            this.value = value;
            updateStructure();
        });

        document.getElementById('namespace').addEventListener('input', function() {
            let value = this.value.toLowerCase().replace(/[^a-z0-9_]/g, '_');
            this.value = value;
            updateStructure();
        });

        document.getElementById('minecraftVersion').addEventListener('change', function() {
            updateVersionInfo();
            updateStructure();
        });

        // Inicializar
        updateVersionInfo();
    </script>
</body>
</html>